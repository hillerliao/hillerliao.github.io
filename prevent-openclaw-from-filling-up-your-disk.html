<!DOCTYPE html>
<html lang="zh" prefix="og: http://ogp.me/ns#">
	<head>
		<link href="http://gmpg.org/xfn/11" rel="profile">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta http-equiv="content-type" content="text/html; charset=utf-8">

		<!-- Metadata -->
	<meta name="description" content="">
	<meta property="og:description" content="">
	<meta property="og:title" content="我替你踩坑了：部署 OpenClaw 后，记得先做这一步，防止服务器被跑死" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://hillerliao.github.io/prevent-openclaw-from-filling-up-your-disk.html" />
		<meta property="og:image" content="https://hillerliao.github.io/images/avatar.jpg" />

		<!-- Enable responsiveness on mobile devices-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

		<title>我替你踩坑了：部署 OpenClaw 后，记得先做这一步，防止服务器被跑死 - 互联网产品折腾师</title>

		<!-- CSS -->
		<link href="//fonts.googleapis.com/" rel="dns-prefetch">
		<link href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Abril+Fatface|PT+Sans:400,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet">

		<link rel="stylesheet" href="https://hillerliao.github.io/theme/css/poole.css" />
		<link rel="stylesheet" href="https://hillerliao.github.io/theme/css/hyde.css" />
		<link rel="stylesheet" href="https://hillerliao.github.io/theme/css/syntax.css" />
			<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.1.7/css/fork-awesome.min.css" crossorigin="anonymous">

		<!-- Feeds -->
<link href="https://hillerliao.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="廖智海 Full Atom Feed" />
<link href="https://hillerliao.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="廖智海 Full RSS Feed" />
<link href="https://hillerliao.github.io/feeds/tech.atom.xml" type="application/atom+xml" rel="alternate" title="廖智海 Categories Atom Feed" />

		<!-- Analytics -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-79917414-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-79917414-1');
</script>
	</head>

	<body class="theme-base-0d">
<div class="sidebar">
	<div class="container sidebar-sticky">
		<div class="sidebar-about">

			<h1>
				<a href="https://hillerliao.github.io/">
					<img class="profile-picture" src="https://hillerliao.github.io/images/avatar.jpg">
					廖智海
				</a>
			</h1>
			<p class="lead"></p>
			<p class="lead"> </p>
			<p></p>
		</div>
			<ul class="sidebar-nav">
			</ul>
		<nav class="sidebar-social">
					<a class="sidebar-social-item" href="https://twitter.com/hillerliao" target="_blank">
						<i class="fa fa-twitter"></i>
					</a>
					<a class="sidebar-social-item" href="https://github.com/hillerliao" target="_blank">
						<i class="fa fa-github"></i>
					</a>
			<a class="sidebar-social-item" href="https://hillerliao.github.io/feeds/all.atom.xml">
				<i class="fa fa-rss"></i>
			</a>
		</nav>
	</div>
</div>		<div class="content container">
<div class="post">
	<h1 class="post-title">我替你踩坑了：部署 OpenClaw 后，记得先做这一步，防止服务器被跑死</h1>
	<span class="post-date">Thu 26 February 2026</span>
	<h1>我替你踩坑了：部署 OpenClaw 后，记得先做这一步</h1>
<p>如果你已经把 OpenClaw 跑起来了，这篇文章建议你花 5 分钟看完，<strong>可以直接帮你避开服务器跑死的坑</strong>。</p>
<hr>
<h2>不想看过程？直接照做这 3 步</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. 清理已有日志</span>
sudo<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/tmp/openclaw/*.log
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># 2. 设置日志上限（单文件 &gt;1GB 自动删）</span>
sudo<span class="w"> </span>tee<span class="w"> </span>/usr/local/bin/openclaw-log-guard.sh<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">#!/bin/bash</span>
<span class="s">find /tmp/openclaw -name &quot;*.log&quot; -size +1G -delete</span>
<span class="s">EOF</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/local/bin/openclaw-log-guard.sh
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># 3. 每小时执行一次</span>
<span class="o">(</span>crontab<span class="w"> </span>-l<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;0 * * * * /usr/local/bin/openclaw-log-guard.sh&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>crontab<span class="w"> </span>-
</code></pre></div>

<p>做到这里就够了。
下面是我为什么会踩到这个坑。</p>
<hr>
<h2>事情背景：早上 7 点，服务器告警</h2>
<p>早上七点多，收到阿里云短信：</p>
<blockquote>
<p>磁盘使用率超过 95%</p>
</blockquote>
<hr>
<h2>一、确认磁盘真的满了</h2>
<div class="highlight"><pre><span></span><code>df<span class="w"> </span>-h
</code></pre></div>

<p>只看一行：</p>
<ul>
<li><code>/</code>（根分区）</li>
<li><code>Use% &gt; 95%</code></li>
</ul>
<hr>
<h2>二、到底是谁在占磁盘？</h2>
<h3>1️⃣ 先看哪个目录最大</h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>du<span class="w"> </span>-sh<span class="w"> </span>/*<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-rh<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-10
</code></pre></div>

<p>结果发现：</p>
<ul>
<li><code>/tmp</code> 占用了 <strong>十几 GB</strong></li>
</ul>
<hr>
<h3>2️⃣ 继续往 <code>/tmp</code> 里找</h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>du<span class="w"> </span>-sh<span class="w"> </span>/tmp/*<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-rh<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-10
</code></pre></div>

<p>当时最扎眼的一行是：</p>
<div class="highlight"><pre><span></span><code>10G   /tmp/openclaw
</code></pre></div>

<hr>
<h3>3️⃣ 看里面是什么</h3>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-lh<span class="w"> </span>/tmp/openclaw
</code></pre></div>

<p>看到的是几个日志文件：</p>
<ul>
<li>一个接近 <strong>9GB</strong></li>
<li>另一个 <strong>1GB+</strong></li>
</ul>
<p>到这里已经可以确定：</p>
<blockquote>
<p><strong>是 OpenClaw 日志把磁盘写满了</strong></p>
</blockquote>
<hr>
<h2>三、这些日志主要在记什么？</h2>
<p>查看日志里主要的错误信息：</p>
<div class="highlight"><pre><span></span><code><span class="nv">grep</span><span class="w"> </span><span class="o">-</span><span class="nv">Ei</span><span class="w"> </span><span class="s2">&quot;disconnect|reconnect|unauthorized|token|1008|ws&quot;</span><span class="w"> </span><span class="o">/</span><span class="nv">tmp</span><span class="o">/</span><span class="nv">openclaw</span><span class="o">/</span><span class="nv">openclaw</span><span class="o">-</span><span class="mi">2026</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">24</span>.<span class="nv">log</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">head</span>
</code></pre></div>

<p>内容主要是三类：</p>
<ol>
<li>
<p><strong>Gateway / WebSocket 日志</strong>
   Web UI 连接、断开、重连都会写。</p>
</li>
<li>
<p><strong>浏览器或工具调用失败日志</strong>
   比如浏览器控制没连上、工具参数不完整，<strong>失败会反复重试</strong>，每次都写一条。</p>
</li>
<li>
<p><strong>插件或消息通道异常日志</strong>
   插件加载了，但目标不匹配，也会持续尝试并记录失败。</p>
</li>
</ol>
<p>重点不在“有没有错误”，而在于：</p>
<blockquote>
<p><strong>这些日志默认没有大小上限</strong></p>
</blockquote>
<p>一旦进入异常循环，文件会一直涨。</p>
<hr>
<h2>四、我当时怎么处理的（先止血）</h2>
<h3>1️⃣ 直接删日志</h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/tmp/openclaw/*.log
</code></pre></div>

<h3>2️⃣ 再看磁盘</h3>
<div class="highlight"><pre><span></span><code>df<span class="w"> </span>-h
</code></pre></div>

<p>这时根分区使用率降到了 <strong>69% 左右</strong>。</p>
<hr>
<h2>五、真正关键的一步：防止再发生</h2>
<p>只清一次没意义，必须加“上限”。</p>
<h3>限制 OpenClaw 日志大小</h3>
<h4>1️⃣ 新建清理脚本</h4>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/local/bin/openclaw-log-guard.sh<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">#!/bin/bash</span>
<span class="s">find /tmp/openclaw -name &quot;*.log&quot; -size +1G -delete</span>
<span class="s">EOF</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/local/bin/openclaw-log-guard.sh
</code></pre></div>

<p>作用只有一句话：</p>
<blockquote>
<p><strong>任何 OpenClaw 日志文件超过 1GB，就删除</strong></p>
</blockquote>
<hr>
<h4>2️⃣ 设置定时任务（每小时一次）</h4>
<div class="highlight"><pre><span></span><code>crontab<span class="w"> </span>-e
</code></pre></div>

<p>加一行：</p>
<div class="highlight"><pre><span></span><code><span class="mf">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">/</span><span class="nb">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="kr">open</span><span class="n">claw</span><span class="o">-</span><span class="nb">log</span><span class="o">-</span><span class="n">guard</span><span class="mf">.</span><span class="n">sh</span>
</code></pre></div>

<ul>
<li>不频繁</li>
<li>不影响排障</li>
<li>足够安全</li>
</ul>
<hr>
<h2>六、现在的状态</h2>
<ul>
<li>磁盘不再突然 95%+</li>
<li>日志不会无限增长</li>
<li>OpenClaw 正常运行</li>
<li>不需要人工盯着</li>
</ul>
<hr>
<h2>最后一句话</h2>
<blockquote>
<p>部署 OpenClaw 后，
<strong>第一件要做的事是：给日志设上限。</strong></p>
</blockquote>
<p>这个坑我已经踩过了，
你不需要再踩一次。</p>
<p>如果你在部署或使用OpenClaw过程中有碰到问题，都可以进群交流，大多数坑都已经有人踩过了。</p>
<p><img alt="" src="../images/a416b9ca688bec9e83693414c4075eb3.png"></p>

		<span class="post-tags">
			Tags:
			<ul>
					<li><a href="https://hillerliao.github.io/tag/openclaw.html">openclaw</a></li>
					<li><a href="https://hillerliao.github.io/tag/linux.html">linux</a></li>
					<li><a href="https://hillerliao.github.io/tag/server.html">server</a></li>
					<li><a href="https://hillerliao.github.io/tag/log.html">log</a></li>
					<li><a href="https://hillerliao.github.io/tag/disk.html">disk</a></li>
			</ul>
		</span>

</div>
		</div>
	</body>
</html>